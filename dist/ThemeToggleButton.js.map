{"version":3,"file":"ThemeToggleButton.js","names":["React","getConfig","Cookies","Icon","WbSunny","Nightlight","themeCookie","themeCookieExpiry","ThemeToggleButton","cookies","isThemeToggleEnabled","INDIGO_ENABLE_DARK_TOGGLE","getCookieExpiry","today","Date","getFullYear","getMonth","getDate","getCookieOptions","serverURL","domain","hostname","path","expires","addDarkThemeToIframes","iframes","document","getElementsByTagName","iframesLength","length","Array","from","forEach","_","ind","style","createElement","textContent","contentDocument","head","appendChild","removeDarkThemeFromiframes","iframeHead","styleTag","querySelectorAll","find","includes","remove","onToggleTheme","URL","LMS_BASE_URL","theme","get","body","classList","add","set","learningMFEUnitIframe","getElementById","contentWindow","postMessage","origin","className","src","htmlFor","id","defaultChecked","onChange","type"],"sources":["../src/ThemeToggleButton.jsx"],"sourcesContent":["import React from 'react';\nimport { getConfig } from '@edx/frontend-platform';\nimport Cookies from 'universal-cookie';\nimport { Icon } from '@openedx/paragon';\nimport { WbSunny, Nightlight } from '@openedx/paragon/icons';\n\nconst themeCookie = 'indigo-toggle-dark';\nconst themeCookieExpiry = 90; // days\n\nconst ThemeToggleButton = () => {\n  const cookies = new Cookies();\n  const isThemeToggleEnabled = getConfig().INDIGO_ENABLE_DARK_TOGGLE;\n\n  const getCookieExpiry = () => {\n    const today = new Date();\n    return new Date(today.getFullYear(), today.getMonth(), today.getDate() + themeCookieExpiry);\n  };\n\n  const getCookieOptions = (serverURL) => ({ domain: serverURL.hostname, path: '/', expires: getCookieExpiry() });\n\n  const addDarkThemeToIframes = () => {\n    const iframes = document.getElementsByTagName('iframe');\n    const iframesLength = iframes.length;\n    if (iframesLength > 0) {\n      Array.from({ length: iframesLength }).forEach((_, ind) => {\n        const style = document.createElement('style');\n        style.textContent = `\n          body{\n            background-color: #0D0D0E;\n            color: #ccc;\n          }\n          a {color: #ccc;}\n          a:hover{color: #d3d3d3;}\n          `;\n        if (iframes[ind].contentDocument) { iframes[ind].contentDocument.head.appendChild(style); }\n      });\n    }\n  };\n\n  const removeDarkThemeFromiframes = () => {\n    const iframes = document.getElementsByTagName('iframe');\n    const iframesLength = iframes.length;\n\n    Array.from({ length: iframesLength }).forEach((_, ind) => {\n      if (iframes[ind].contentDocument) {\n        const iframeHead = iframes[ind].contentDocument.head;\n        const styleTag = Array.from(iframeHead.querySelectorAll('style')).find(\n          (style) => style.textContent.includes('background-color: #0D0D0E;') && style.textContent.includes('color: #ccc;'),\n        );\n        if (styleTag) {\n          styleTag.remove();\n        }\n      }\n    });\n  };\n\n  const onToggleTheme = () => {\n    const serverURL = new URL(getConfig().LMS_BASE_URL);\n    let theme = '';\n\n    if (cookies.get(themeCookie) === 'dark') {\n      document.body.classList.remove('indigo-dark-theme');\n      removeDarkThemeFromiframes();\n      theme = 'light';\n    } else {\n      document.body.classList.add('indigo-dark-theme');\n      addDarkThemeToIframes();\n      theme = 'dark';\n    }\n    cookies.set(themeCookie, theme, getCookieOptions(serverURL));\n\n    const learningMFEUnitIframe = document.getElementById('unit-iframe');\n    if (learningMFEUnitIframe) {\n      learningMFEUnitIframe.contentWindow.postMessage({ 'indigo-toggle-dark': theme }, serverURL.origin);\n    }\n  };\n\n  if (!isThemeToggleEnabled) {\n    return <div />;\n  }\n\n  return (\n    <div className=\"theme-toggle-button\">\n      <div className=\"light-theme-icon\"><Icon src={WbSunny} /></div>\n      <div className=\"toggle-switch\">\n        <label htmlFor=\"theme-toggle-checkbox\" className=\"switch\">\n          <input id=\"theme-toggle-checkbox\" defaultChecked={cookies.get(themeCookie) === 'dark'} onChange={onToggleTheme} type=\"checkbox\" />\n          <span className=\"slider round\" />\n        </label>\n      </div>\n      <div className=\"dark-theme-icon\"><Icon src={Nightlight} /></div>\n    </div>\n  );\n};\n\nexport default ThemeToggleButton;\n"],"mappings":"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","ignoreList":[]}